# Confguration generated by puppet for project "<%= vhost_domain %>"

<% if vhost_ip != '' %>NameVirtualHost <%= vhost_ip %> <% end -%>
<VirtualHost <% if vhost_ip != '' %><%= vhost_ip %><% else %>*<% end -%>:80>

	ServerName www.<%= vhost_domain %>
	<% if vhost_server_alias != '' %> ServerAlias <%= vhost_server_alias %> <% end -%>
	UseCanonicalName Off

	ServerAdmin <%= vhost_server_admin %>
	DocumentRoot <%= vhost_root %>

	DirectoryIndex index.php index.html

	# [logging]
	ErrorLog /var/log/apache2/<%= vhost_domain %>-error.log
	CustomLog /var/log/apache2/<%= vhost_domain %>-access.log combined

	<Directory />
		Options FollowSymLinks
		AllowOverride None
	</Directory>

	<Directory "/var/www/<%= vhost_domain %>">
		Options <%= vhost_domain_options %>
		AllowOverride <%= vhost_domain_allow_override %>
		Order <%= vhost_domain_order %>
		Allow from all
	</Directory>

	# open up the possibility to set some custom directives
	Include "vhost-custom.d/<%= vhost_domain %>-custom.conf"

</VirtualHost>

# redirect every request to the pure domain back 
# to www
<VirtualHost <% if vhost_ip != '' %><%= vhost_ip %><% else %> *<% end -%>:80>
 	ServerName <%= vhost_domain %>
	Redirect 301 / http://www.<%= vhost_domain %>/
</VirtualHost>



# (c) 2012 chris@adminwerk.de